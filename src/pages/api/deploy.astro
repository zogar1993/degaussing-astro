---
export const prerender = false

const CRON_SECRET = import.meta.env.CRON_SECRET!

export async function GET({ request }) {
	if (request.headers.get('Authorization') !== `Bearer ${CRON_SECRET}`) {
		return new Response(null, { status: 401 })
	}

	try {
		await fetch("https://api.vercel.com/v1/integrations/deploy/prj_XXXX/deploy", {
			method: "POST",
			headers: { Authorization: `Bearer YOUR_VERCEL_TOKEN` }
		})

		return new Response(null, { status: 204 })
	} catch (e) {
		return new Response(JSON.stringify(e), {
			status: 500,
			statusText: "Not found",
			headers: {
				"Content-Type": "application/json"
			}
		})
	}
}
---